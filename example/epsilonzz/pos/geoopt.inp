&GLOBAL
  PROJECT geoopt
  RUN_TYPE GEO_OPT
  PRINT_LEVEL LOW
&END GLOBAL
&FORCE_EVAL
  METHOD Quickstep
  &SUBSYS
    &KIND Ca
      ELEMENT	Ca
      BASIS_SET DZVP-MOLOPT-SR-GTH-q10
      POTENTIAL GTH-PBE
    &END KIND
	&KIND Si
      ELEMENT	Si
      BASIS_SET DZVP-MOLOPT-SR-GTH-q4
      POTENTIAL GTH-PBE
    &END KIND
	&KIND O
      ELEMENT	O
      BASIS_SET DZVP-MOLOPT-SR-GTH-q6
      POTENTIAL GTH-PBE
    &END KIND
    &KIND H
      ELEMENT	H
      BASIS_SET DZVP-MOLOPT-SR-GTH-q1
      POTENTIAL GTH-PBE
    &END KIND
    &CELL
      A  10.5818447963 0.0000000000 0.0000000000
      B  -4.9423550439 13.7389647795 0.0000000000
      C  -0.9565922715 -2.7547349881 10.2650350053
      PERIODIC XYZ
	  MULTIPLE_UNIT_CELL 1 1 1
    &END CELL
	&TOPOLOGY
	  COORD_FILE_NAME coord.xyz
	  COORDINATE xyz
	  MULTIPLE_UNIT_CELL 1 1 1
	&END
  &END SUBSYS
  &DFT
    BASIS_SET_FILE_NAME  BASIS_MOLOPT
    POTENTIAL_FILE_NAME  POTENTIAL
	MULTIPLICITY 1
    CHARGE 0
    &QS
      EPS_DEFAULT 1.0E-12
    &END QS
    &POISSON
      PERIODIC XYZ
      PSOLVER PERIODIC
    &END POISSON
    &MGRID
      NGRIDS 4
      CUTOFF 500
      REL_CUTOFF 70
    &END MGRID
    &XC
      &XC_FUNCTIONAL
        &PBE
          PARAMETRIZATION PBESOL
        &END PBE
      &END XC_FUNCTIONAL
      &VDW_POTENTIAL
        POTENTIAL_TYPE PAIR_POTENTIAL
        &PAIR_POTENTIAL
          PARAMETER_FILE_NAME dftd3.dat
          TYPE DFTD3(BJ)
          REFERENCE_FUNCTIONAL PBEsol
          #CALCULATE_C9_TERM T #Calculate C9-related three-body term, more accurate for large system
        &END PAIR_POTENTIAL
      &END VDW_POTENTIAL
    &END XC
    &SCF
      EPS_SCF 1.0E-7
      MAX_SCF 25
      IGNORE_CONVERGENCE_FAILURE T
	  &OT T
	    ALGORITHM STRICT
		MINIMIZER DIIS
		LINESEARCH 2PNT
		PRECONDITIONER FULL_KINETIC
	  &END OT
      &OUTER_SCF T
         EPS_SCF  1.0E-7
         MAX_SCF 20
       &END OUTER_SCF
       &PRINT
         &RESTART SILENT
           BACKUP_COPIES 0
         &END RESTART
       &END PRINT
    &END SCF
  &END DFT
  &PRINT
    &STRESS_TENSOR ON #Print stress tensor
    &END STRESS_TENSOR
    &FORCES ON
    &END FORCES
  &END PRINT
  STRESS_TENSOR ANALYTICAL
&END FORCE_EVAL
&MOTION
  &GEO_OPT
    MAX_ITER 1000
    #STEP_START_VAL 150	
    KEEP_SPACE_GROUP F
    MAX_DR 3E-3
    RMS_DR 1.5E-3 
    MAX_FORCE 4.5E-4 
    RMS_FORCE 3E-4
    OPTIMIZER BFGS
    &BFGS
      TRUST_RADIUS 0.2 #in Angstrom
    &END BFGS
  &END GEO_OPT
  &PRINT
    &TRAJECTORY
      FORMAT xyz
    &END TRAJECTORY
    &CELL
    &END CELL
    &RESTART
      BACKUP_COPIES 0 
    &END RESTART
    &RESTART_HISTORY OFF 
    &END RESTART_HISTORY
  &END PRINT
&END MOTION